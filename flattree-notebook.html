<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FlatTree Notebook &#8212; treekit 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="API Reference: treekit Package" href="api.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="flattree-notebook">
<h1><code class="docutils literal notranslate"><span class="pre">FlatTree</span> <span class="pre">Notebook</span></code><a class="headerlink" href="#flattree-notebook" title="Link to this heading">¶</a></h1>
<p>In this notebook, we explore the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> data structure, which is a
tree with a flat memory layout. This data structure is useful when we
want to store a tree in a contiguous memory block. We will implement the
<code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> data structure and demonstrate how to perform various
operations on it.</p>
<p>We also demonstrate the <code class="docutils literal notranslate"><span class="pre">FlatTreeNode</span></code> proxy class, which allows us to
access the nodes of the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> using a tree-like interface.</p>
<p>Let’s load the required libraries and create a <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> data
structure using the node interface.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treekit.flattree_node</span> <span class="kn">import</span> <span class="n">FlatTreeNode</span>
<span class="kn">from</span> <span class="nn">treekit.tree_viz</span> <span class="kn">import</span> <span class="n">TreeViz</span>
<span class="kn">from</span> <span class="nn">treekit.tree_converter</span> <span class="kn">import</span> <span class="n">TreeConverter</span>
<span class="kn">from</span> <span class="nn">treekit.flattree</span> <span class="kn">import</span> <span class="n">FlatTree</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">node1</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node1&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">node2</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node2&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">node3</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">node4</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node4&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">node5</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node5&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">node6</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node6&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">node7</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node7&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">node8</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node8&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">node9</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node9&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node6</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">_tree</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span>
    <span class="n">root</span><span class="p">,</span>
    <span class="n">node1</span><span class="p">,</span>
    <span class="n">node2</span><span class="p">,</span>
    <span class="n">node3</span><span class="p">,</span>
    <span class="n">node4</span><span class="p">,</span>
    <span class="n">node5</span><span class="p">,</span>
    <span class="n">node6</span><span class="p">,</span>
    <span class="n">node7</span><span class="p">,</span>
    <span class="n">node8</span><span class="p">,</span>
    <span class="n">node9</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ValueError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__ROOT__</span> <span class="p">{}</span> <span class="kc">None</span>

<span class="n">root</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="kc">None</span>

<span class="n">node1</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="n">node2</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="n">node3</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="n">node4</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">node5</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">node6</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">node7</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">node8</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">node9</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node6</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
</pre></div>
</div>
<p>Let’s do something similar, but using the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code>’s <code class="docutils literal notranslate"><span class="pre">dict</span></code> or
<code class="docutils literal notranslate"><span class="pre">json</span></code> constructor. This is more direct and makes it explicit what
data the tree is providing a <em>view</em> of. After all, the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> is
itself just a <code class="docutils literal notranslate"><span class="pre">dict</span></code> of a particular shape.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># &quot;parent&quot;: None,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;more&quot;</span><span class="p">:</span> <span class="s2">&quot;Some more data for node1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;node2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># &quot;parent&quot;: &quot;node1&quot;,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node2&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;Some test data for node3&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span><span class="p">},</span>
    <span class="s2">&quot;node5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node5&quot;</span><span class="p">},</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;more&quot;</span><span class="p">:</span> <span class="s2">&quot;Some more data for node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node2&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;Some test data for node3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node5&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load a tree from tree_data</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">FlatTree</span><span class="p">(</span><span class="n">tree_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;more&quot;</span><span class="p">:</span> <span class="s2">&quot;Some more data for node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node2&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;Some test data for node3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node5&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;real_root&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;real_root&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">real_root</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_child&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;test_child_value&quot;</span><span class="p">)</span>
<span class="n">child2</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_child2&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;test_child_value2&quot;</span><span class="p">)</span>
<span class="n">child2</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_child3&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;test_child_value3&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;real_root&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;test_child&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;test_child_value&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;real_root&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;test_child2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;test_child_value2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;real_root&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;test_child3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;test_child_value3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;test_child2&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child2_test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;test_child2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">child2_test</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">child2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">child2_test</span> <span class="o">==</span> <span class="n">child2</span>
<span class="n">child3_test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;test_child3&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">child3_test</span> <span class="o">!=</span> <span class="n">child2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">child3_test</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">child2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">test_child2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">real_root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;test_child_value2&#39;</span><span class="p">})</span>
 <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">test_child2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">real_root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;test_child_value2&#39;</span><span class="p">})</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">test_child3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">test_child2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;test_child_value3&#39;</span><span class="p">})</span>
 <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">test_child2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">real_root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;test_child_value2&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">*</span> <span class="n">depth</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">*</span> <span class="n">depth</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">depth</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="n">pretty_print</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">pretty_print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<span class="n">pretty_print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__ROOT__</span>
     <span class="o">|</span>
     <span class="o">+</span> <span class="o">-</span> <span class="n">node1</span>
         <span class="o">|</span>
         <span class="o">+</span> <span class="o">--</span> <span class="n">node3</span>
             <span class="o">|</span>
             <span class="o">+</span> <span class="o">---</span> <span class="n">node4</span>
             <span class="o">|</span>
             <span class="o">+</span> <span class="o">---</span> <span class="n">node5</span>
     <span class="o">|</span>
     <span class="o">+</span> <span class="o">-</span> <span class="n">node2</span>
<span class="n">__ROOT__</span>
     <span class="o">|</span>
     <span class="o">+</span> <span class="o">-</span> <span class="n">real_root</span>
         <span class="o">|</span>
         <span class="o">+</span> <span class="o">--</span> <span class="n">test_child</span>
         <span class="o">|</span>
         <span class="o">+</span> <span class="o">--</span> <span class="n">test_child2</span>
             <span class="o">|</span>
             <span class="o">+</span> <span class="o">---</span> <span class="n">test_child3</span>
</pre></div>
</div>
<p>For now on, when viewing trees, we use the <code class="docutils literal notranslate"><span class="pre">TreeViz</span></code> class to
visualize the trees. It has a <code class="docutils literal notranslate"><span class="pre">text</span></code> and <code class="docutils literal notranslate"><span class="pre">image</span></code> method to display
the tree in text and image format respectively.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">anytree</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">anytree</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">),</span> <span class="n">target_type</span><span class="o">=</span><span class="n">Node</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">anytree</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>node1
└── node3
    ├── node4
    └── node5
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">anytree</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anytree</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anytree</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ancestors</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anytree</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">siblings</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anytree</span><span class="o">.</span><span class="n">is_root</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="s1">&#39;/node1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;Some data for node1&#39;</span><span class="p">,</span> <span class="n">more</span><span class="o">=</span><span class="s1">&#39;Some more data for node1&#39;</span><span class="p">),</span> <span class="n">Node</span><span class="p">(</span><span class="s1">&#39;/node1/node3&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;Some data for node3&#39;</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;Some test data for node3&#39;</span><span class="p">))</span>
<span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="s1">&#39;/node1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;Some data for node1&#39;</span><span class="p">,</span> <span class="n">more</span><span class="o">=</span><span class="s1">&#39;Some more data for node1&#39;</span><span class="p">),)</span>
<span class="p">()</span>
<span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">anytree</span><span class="p">,</span> <span class="s2">&quot;images/anytree.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the image (<code class="docutils literal notranslate"><span class="pre">anytree.png</span></code> from above) of the tree:</p>
<figure class="align-default" id="id1">
<img alt="tree" src="_images/anytree.png" />
<figcaption>
<p><span class="caption-text">tree</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We may want to show different or more information in the image. In order
to do so, firs we shold convert <code class="docutils literal notranslate"><span class="pre">tree</span></code> to any <code class="docutils literal notranslate"><span class="pre">anytree.Node</span></code> that
carries more information.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detailed_node_info</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">payload</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>


<span class="n">anytree2</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">node_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">node</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="n">detailed_node_info</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span>
    <span class="n">anytree2</span><span class="p">,</span>
    <span class="s2">&quot;images/anytree-more.png&quot;</span><span class="p">,</span>
    <span class="n">node_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">node</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>
    <span class="o">+</span> <span class="s2">&quot;: &quot;</span>
    <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span>
    <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">children: &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Here is the image:</p>
<figure class="align-default" id="id2">
<img alt="tree" src="_images/anytree-more.png" />
<figcaption>
<p><span class="caption-text">tree</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> class provides a <strong>view</strong> of a <code class="docutils literal notranslate"><span class="pre">dict</span></code> object as a
tree. We do not modify the <code class="docutils literal notranslate"><span class="pre">dict</span></code> passed into it (and you can create a
dict through the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> API).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> class has a number of methods and properties to help
you navigate the tree. A particular aspect of the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> class is
that it unifies any <code class="docutils literal notranslate"><span class="pre">dict</span></code> object into a tree structure. The keys are
the node names and the values are the node values. If the value has no
parent, it is a child of a <code class="docutils literal notranslate"><span class="pre">LOGICAL_ROOT</span></code> node that is computed lazily
on demand (and is not a part of the actual underlying <code class="docutils literal notranslate"><span class="pre">dict</span></code> object).
In this way, every dict is a tree, and every tree is a dict, with the
exception that undefined behavior may result if the <code class="docutils literal notranslate"><span class="pre">dict</span></code> has keys
that map to values in which a <code class="docutils literal notranslate"><span class="pre">parent</span></code> key is defined but results in a
cycle or a node that is not in the <code class="docutils literal notranslate"><span class="pre">dict</span></code>. In this case, it will still
try to work with it, but the behavior is undefined. You can call
<code class="docutils literal notranslate"><span class="pre">FlatTree.check_valid</span></code> to check if the tree is in a valid state.</p>
<p>Since it’s just a view of a <code class="docutils literal notranslate"><span class="pre">dict</span></code> we have all the normal operations
on it that we would have on a <code class="docutils literal notranslate"><span class="pre">dict</span></code> object.</p>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> class to visualize sub-trees rooted at
some node.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> conceptually represents as a whole the
logical root of the tree. However, we have <code class="docutils literal notranslate"><span class="pre">FlatTree.ProxyNode</span></code>
objects that can be used to represent any node in the tree, and supports
the same API as the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> class itself.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node3&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>node3
├── node4
└── node5
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s2">&quot;node2&quot;</span><span class="p">])</span>
<span class="n">node3</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node3</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node3</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node2&#39;</span><span class="p">}</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node1</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node3&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="s1">&#39;Some test data for node3&#39;</span><span class="p">})</span>
<span class="n">node1</span>
<span class="p">[</span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node4</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node4&#39;</span><span class="p">}),</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node5</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node5&#39;</span><span class="p">})]</span>
</pre></div>
</div>
<p>We show that it’s easy to regenerate any JSON files that may have been
used to generate the FlatTree ‘tree’. So, JSON is a good format for
storing and transmitting trees. And, of course, <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> <em>is</em> a
dictionary. Of course, if we store an object that has no serializable
representation, it cannot be stored in JSON.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s create a tree from a dict that cannot be serialized to json</span>
<span class="n">non_serializable_tree_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># data maps tp a function that cannot be serialized</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
        <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span>
        <span class="o">+</span> <span class="mi">5</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">non_serializable_tree</span> <span class="o">=</span> <span class="n">FlatTree</span><span class="p">(</span><span class="n">non_serializable_tree_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">non_serializable_tree</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">non_serializable_tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;node1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="o">&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x7f7324d2c790</span><span class="o">&gt;</span><span class="p">}}</span>
<span class="n">Object</span> <span class="n">of</span> <span class="nb">type</span> <span class="n">function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">JSON</span> <span class="n">serializable</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node36&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node36&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node36</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node36&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node15&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node15&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node1
│   ├── node3
│   │   ├── node4
│   │   └── node5
│   └── node15
├── node2
└── node36
</pre></div>
</div>
<p>If we try too add a non-unique node key to the tree, we will get a
<code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">child2</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node2&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node2!!!&quot;</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;key already exists in the tree: node2&#39;</span>
</pre></div>
</div>
<p>Let’s add some more nodes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child7</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node7&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node7&quot;</span><span class="p">)</span>
<span class="n">child7</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node17&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node17&quot;</span><span class="p">)</span>
<span class="n">child7</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node27&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node27&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node37&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Some data for node37&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">TreeConverter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">child7</span><span class="p">,</span> <span class="n">Node</span><span class="p">),</span> <span class="n">node_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Node(&#39;/node7&#39;, data=&#39;Some data for node7&#39;)
├── Node(&#39;/node7/node17&#39;, data=&#39;Some data for node17&#39;)
└── Node(&#39;/node7/node27&#39;, data=&#39;Some data for node27&#39;)
    └── Node(&#39;/node7/node27/node37&#39;, data=&#39;Some data for node37&#39;)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s view the full tree with the <code class="docutils literal notranslate"><span class="pre">TreeViz.image</span></code> method.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;images/big_tree.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here’s the tree:</p>
<figure class="align-default" id="id3">
<img alt="big_tree" src="_images/big_tree.png" />
<figcaption>
<p><span class="caption-text">big_tree</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We can see that the underlying tree that the child is a member of has
been appropriately modified:</p>
<p>We also support conversions to and from <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code>, <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>, and
<code class="docutils literal notranslate"><span class="pre">anytree.Node</span></code> objects, or any other object which has an <code class="docutils literal notranslate"><span class="pre">__init__</span></code>
method that takes arguments, or keyword arguments, and also has
arguments for <code class="docutils literal notranslate"><span class="pre">parent</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>The function is called <code class="docutils literal notranslate"><span class="pre">TreeConverter.copy_under</span></code> which accepts a
<code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> object, and copies the <code class="docutils literal notranslate"><span class="pre">source</span></code> object under
the <code class="docutils literal notranslate"><span class="pre">target</span></code> object. The source is normally a node of some kind, and
the target is another node, and the result is the tree structure under
the source node is copied under the target node. The source node is not
modified in any way.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">anytree</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">treekit.treenode</span> <span class="kn">import</span> <span class="n">TreeNode</span>

<span class="n">tree1</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;anytree&quot;</span><span class="p">))</span>
<span class="n">tree2</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;treenode&quot;</span><span class="p">))</span>
<span class="n">tree3</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;flattreenode&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree3</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="n">tree4</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">tree3</span><span class="p">,</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;flattreenode2&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree4</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node1
│   ├── node3
│   │   ├── node4
│   │   └── node5
│   └── node15
├── node2
└── node36
    └── node7
        ├── node17
        └── node27
            └── node37

anytree
├── node1
│   ├── node3
│   │   ├── node4
│   │   └── node5
│   └── node15
├── node2
└── node36
    └── node7
        ├── node17
        └── node27
            └── node37

treenode
├── node1
│   ├── node3
│   │   ├── node4
│   │   └── node5
│   └── node15
├── node2
└── node36
    └── node7
        ├── node17
        └── node27
            └── node37

flattreenode
├── node1
│   ├── node3
│   │   ├── node4
│   │   └── node5
│   └── node15
├── node2
└── node36
    └── node7
        ├── node17
        └── node27
            └── node37

__ROOT__
└── flattreenode
    ├── node1
    │   ├── node3
    │   │   ├── node4
    │   │   └── node5
    │   └── node15
    ├── node2
    └── node36
        └── node7
            ├── node17
            └── node27
                └── node37

flattreenode2
└── flattreenode
    ├── node1
    │   ├── node3
    │   │   ├── node4
    │   │   └── node5
    │   └── node15
    ├── node2
    └── node36
        └── node7
            ├── node17
            └── node27
                └── node37
</pre></div>
</div>
<p>We can iterate over the items of the child and we can modify/delete its
data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">child7</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

<span class="n">child7</span><span class="p">[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for node7&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">child7</span><span class="p">)</span>

<span class="k">del</span> <span class="n">child7</span><span class="p">[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span>
<span class="n">child7</span><span class="p">[</span><span class="s2">&quot;other_new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some other data for node7&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">child7</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
<span class="n">parent</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node7</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node36</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node7&#39;</span><span class="p">,</span> <span class="s1">&#39;new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some new data for node7&#39;</span><span class="p">})</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node7</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node36</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some data for node7&#39;</span><span class="p">,</span> <span class="s1">&#39;other_new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some other data for node7&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Let’s create a tree from a dictionary that refers to a non-existent
parent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">non_existent_parent_tree</span> <span class="o">=</span> <span class="n">FlatTree</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;non_existent_parent&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">non_existent_parent_tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
    <span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">non_existent_parent_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__ROOT__</span>

<span class="s2">&quot;Parent &#39;non_existent_parent&#39; not in tree for node &#39;node1&#39;&quot;</span>
</pre></div>
</div>
<p>We see that the node is disconnected from the logical root, since it
refers to a non-existent parent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">cycle_tree</span> <span class="o">=</span> <span class="n">FlatTree</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;node0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node0&quot;</span><span class="p">},</span>
            <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node2&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">},</span>
            <span class="s2">&quot;node2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node2&quot;</span><span class="p">},</span>
            <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">},</span>
            <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node0&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span><span class="p">},</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">cycle_tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
    <span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">cycle_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
└── node0
    └── node4

Cycle detected: {&#39;node1&#39;, &#39;node2&#39;, &#39;node3&#39;}
</pre></div>
</div>
<p>We see that the tree was in an invalid state. In particular, nodes 1, 2,
and 3 are disconnected from the logical root and in a cycle. We can fix
this by breaking the cycle and setting the parent of node 3 to, for
instance, the logical root (by setting it to <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_tree</span><span class="p">[</span><span class="s2">&quot;node3&quot;</span><span class="p">][</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">cycle_tree</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">cycle_tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node0
│   └── node4
└── node3
    └── node2
        └── node1
</pre></div>
</div>
<p>Let’s look at the tree again, and see about creating a cycle.</p>
<p>We will make node 1 the parent of node 5, to create a cycle:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">new_tree</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="n">new_tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)[</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;node5&quot;</span>
    <span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cycle</span> <span class="n">detected</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;node1&#39;</span><span class="p">,</span> <span class="s1">&#39;node5&#39;</span><span class="p">,</span> <span class="s1">&#39;node3&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Notice that we use <code class="docutils literal notranslate"><span class="pre">deepcopy</span></code> to avoid modifying the original tree
with these invalid operations. We chose to do it this way so as to not
incur the overhead of reverting the tree to a valid state after an
invalid operation. This way, we can keep the tree in an invalid state
for as long as we want, and only revert it to a valid state when we want
to.</p>
<p>Each node is a key-value pair in the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code>. We have the
<code class="docutils literal notranslate"><span class="pre">FlatTree.ProxyNode</span></code> so that we can have an API focused on the nodes
and not the underlying dictionary. However, we stiill permit access to
the underlying dictionary. When you modify the tree in this way, we
still maintain the integrity of the tree.</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> represents nodes as key-value pairs, and the
value may have a parent key, along with any other arbitrary data, each
value for a node must be a dictionary.</p>
<p>Below, we see that trying to add a <code class="docutils literal notranslate"><span class="pre">test</span></code> node with a non-dictionary
value generates an error.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">error_tree</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="c1"># this will raise a ValueError because the node with key `test` maps to</span>
    <span class="c1"># string instead of a dict.</span>
    <span class="n">error_tree</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some test data&quot;</span>
    <span class="n">FlatTree</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">error_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Node</span> <span class="s1">&#39;test&#39;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">dictionary</span><span class="p">:</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Some test data&#39;</span>
</pre></div>
</div>
<p>Let’s manipulate the tree a bit more using the <code class="docutils literal notranslate"><span class="pre">dict</span></code> API. We’re just
going to add a <code class="docutils literal notranslate"><span class="pre">new_node</span></code> with some data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="p">[</span><span class="s2">&quot;new_node&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some new data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ABCDEFG&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;new_node&quot;</span><span class="p">),</span>
        <span class="n">node_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">ABCDEFG</span><span class="p">,</span>
        <span class="n">extract</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_node</span><span class="p">:</span> <span class="n">Some</span> <span class="n">other</span> <span class="n">data</span><span class="p">:</span> <span class="n">Some</span> <span class="n">other</span> <span class="n">data</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>node1
├── node3
│   ├── node4
│   └── node5
├── node15
└── new_node
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;more&quot;</span><span class="p">:</span> <span class="s2">&quot;Some more data for node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node2&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;Some test data for node3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node5&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node36&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node36&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node15&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node15&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node7&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node36&quot;</span><span class="p">,</span>
    <span class="s2">&quot;other_new_data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data for node7&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node17&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node17&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node7&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node27&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node27&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node7&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node37&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node27&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;new_node&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some new data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ABCDEFG&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The logical root node is not a part of the underlying dictionary, so we
can’t access it through the <code class="docutils literal notranslate"><span class="pre">dict</span></code> API. It’s non-children data are
also immutable through the <code class="docutils literal notranslate"><span class="pre">FlatTreeNode</span></code> API.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root_node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span>
<span class="nb">print</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">root_node</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for root node&quot;</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">root_node</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">root_node</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">__ROOT__</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{})</span>
<span class="n">__ROOT__</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">immutable</span> <span class="n">logical</span> <span class="n">root</span>
<span class="n">__ROOT__</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">immutable</span> <span class="n">logical</span> <span class="n">root</span>
</pre></div>
</div>
<p>We can <em>detach</em> nodes. Let’s first view the full tree, pre-detachment.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;images/full-tree-pre-detach-or-prune.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here’s the full tree prior to any detachment or pruning:</p>
<figure class="align-default" id="id4">
<img alt="full-tree-pre-detach-or-prune" src="_images/full-tree-pre-detach-or-prune.png" />
<figcaption>
<p><span class="caption-text">full-tree-pre-detach-or-prune</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Let’s detach nodes 36 and 2 and view the tree, which should now be
missing those nodes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node36&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
<span class="n">tree</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="s2">&quot;node2&quot;</span><span class="p">)</span>
<span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;images/full-tree-post-detach.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s view the tree with the detached nodes.</p>
<figure class="align-default" id="id5">
<img alt="full-tree-post-detach" src="full-tree-post-detach.png" />
<figcaption>
<p><span class="caption-text">full-tree-post-detach</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We see that node 36 (and any of its children) and node 2 are no longer
attached to the logical root, which represents the root of the tree.
However, they’re not gone – just detached. We can view the detached
nodes with:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">detached</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__DETACHED__
├── node2
└── node36
    └── node7
        ├── node17
        └── node27
            └── node37
</pre></div>
</div>
<p>We can prune (delete) nodes (and their descendants) from the tree with
the <code class="docutils literal notranslate"><span class="pre">prune</span></code> method. The prune method takes either a node key or a
<code class="docutils literal notranslate"><span class="pre">FlatTreeNode</span></code> object. Let’s prune the detached nodes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># tree.prune(&quot;__DETACHED__&quot;)</span>
<span class="n">pruned_keys</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">prune</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">detached</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pruned_keys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;node2&#39;</span><span class="p">,</span> <span class="s1">&#39;node36&#39;</span><span class="p">,</span> <span class="s1">&#39;node7&#39;</span><span class="p">,</span> <span class="s1">&#39;node17&#39;</span><span class="p">,</span> <span class="s1">&#39;node27&#39;</span><span class="p">,</span> <span class="s1">&#39;node37&#39;</span><span class="p">]</span>
<span class="p">{</span>
  <span class="s2">&quot;node1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;more&quot;</span><span class="p">:</span> <span class="s2">&quot;Some more data for node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;Some test data for node3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node4&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node5&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;node15&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node15&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;new_node&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some new data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ABCDEFG&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can prune any subtree from the tree. Let’s prune the subtree rooted
at node 3.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pruned_keys</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">prune</span><span class="p">(</span><span class="s2">&quot;node3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pruned_keys</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node3&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">TreeViz</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;images/post-prune-node-3.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pruned_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;node3&#39;</span><span class="p">,</span> <span class="s1">&#39;node4&#39;</span><span class="p">,</span> <span class="s1">&#39;node5&#39;</span><span class="p">]</span>
<span class="s2">&quot;Key not found: &#39;node3&#39;&quot;</span>
</pre></div>
</div>
<p>Let’s view the tree after pruning node 3.</p>
<figure class="align-default" id="id6">
<img alt="post-prune-node-3" src="post-prune-node-3.png" />
<figcaption>
<p><span class="caption-text">post-prune-node-3</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We have a fairly complete API for manipulating the tree. Let’s explore
some additional methods.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for node1&quot;</span>
<span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node1&quot;</span><span class="p">)[</span><span class="s2">&quot;other_new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some other data for node1&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s2">&quot;node1&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some new data for node1&#39;</span><span class="p">,</span> <span class="s1">&#39;other_new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some other data for node1&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>This is fairly self-expalanatory. Let’s add some more nodes without
specifying a key name for them, since often we don’t care about the key
name and it’s only for bookkeeping purposes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node4what&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">FlatTreeNode</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node2000&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node15&quot;</span><span class="p">))</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node200&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>


<span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;new_node&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node200&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node1
│   ├── node15
│   │   └── 88fcbeb5-87f4-4e81-a4f2-1865c9b57902
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
└── node200
    └── new_node
        └── node2000
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node15</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node15&quot;</span><span class="p">)</span>


<span class="n">node15</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node350&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">350</span><span class="p">)]</span>

<span class="n">node15</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node4000&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">4000</span><span class="p">),</span>
    <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node5000&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">5000</span><span class="p">),</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;new_node&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node1
│   ├── node15
│   │   ├── new_node
│   │   │   └── node2000
│   │   ├── node4000
│   │   └── node5000
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
└── node200

{
  &quot;node1&quot;: {
    &quot;new_data&quot;: &quot;Some new data for node1&quot;,
    &quot;other_new_data&quot;: &quot;Some other data for node1&quot;
  },
  &quot;node15&quot;: {
    &quot;data&quot;: &quot;Some data for node15&quot;,
    &quot;parent&quot;: &quot;node1&quot;
  },
  &quot;new_node&quot;: {
    &quot;parent&quot;: &quot;node15&quot;,
    &quot;data&quot;: &quot;Some new data&quot;,
    &quot;ABCDEFG&quot;: &quot;Some other data&quot;
  },
  &quot;9658556c-aa4a-485e-b499-4900d062c394&quot;: {
    &quot;whatever&quot;: 3
  },
  &quot;node4what&quot;: {
    &quot;whatever&quot;: 4,
    &quot;parent&quot;: &quot;9658556c-aa4a-485e-b499-4900d062c394&quot;
  },
  &quot;6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505&quot;: {
    &quot;whatever&quot;: 5,
    &quot;parent&quot;: &quot;node4what&quot;
  },
  &quot;29a49cbf-365a-47c3-a236-bf40e61960e3&quot;: {
    &quot;whatever&quot;: 1000,
    &quot;parent&quot;: &quot;node1&quot;
  },
  &quot;node2000&quot;: {
    &quot;whatever&quot;: 2000,
    &quot;parent&quot;: &quot;new_node&quot;
  },
  &quot;88fcbeb5-87f4-4e81-a4f2-1865c9b57902&quot;: {
    &quot;whatever&quot;: 3000,
    &quot;parent&quot;: &quot;__DETACHED__&quot;
  },
  &quot;node200&quot;: {
    &quot;whatever&quot;: 200
  },
  &quot;node350&quot;: {
    &quot;whatever&quot;: 350,
    &quot;parent&quot;: &quot;__DETACHED__&quot;
  },
  &quot;node4000&quot;: {
    &quot;whatever&quot;: 4000,
    &quot;parent&quot;: &quot;node15&quot;
  },
  &quot;node5000&quot;: {
    &quot;whatever&quot;: 5000,
    &quot;parent&quot;: &quot;node15&quot;
  }
}
</pre></div>
</div>
<p>Let’s look at some tree conversions. We can convert between different
tree representations and data structures.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_tree</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">TreeNode</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_tree</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;treekit.treenode.TreeNode&#39;&gt;
</pre></div>
</div>
<p>We see that it’s a different type of tree, a <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>, which is a
recursive data structure. Nowever, it’s also a <code class="docutils literal notranslate"><span class="pre">dict</span></code>. Let’s look at
its representation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">new_tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;__ROOT__&quot;</span><span class="p">,</span>
  <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;new_data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some new data for node1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;other_new_data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data for node1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some data for node15&quot;</span><span class="p">,</span>
          <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node15&quot;</span><span class="p">,</span>
          <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some new data&quot;</span><span class="p">,</span>
              <span class="s2">&quot;ABCDEFG&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data&quot;</span><span class="p">,</span>
              <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;new_node&quot;</span><span class="p">,</span>
              <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
                  <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node2000&quot;</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
              <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node4000&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
              <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node5000&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
          <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;29a49cbf-365a-47c3-a236-bf40e61960e3&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;9658556c-aa4a-485e-b499-4900d062c394&quot;</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node4what&quot;</span><span class="p">,</span>
          <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
              <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;whatever&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
      <span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;node200&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We see that it has a very different structure. However, when we
pretty-print it using <code class="docutils literal notranslate"><span class="pre">TreeViz</span></code>, we see that it’s the same tree.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">new_tree</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>__ROOT__
├── node1
│   ├── node15
│   │   ├── new_node
│   │   │   └── node2000
│   │   ├── node4000
│   │   └── node5000
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
└── node200

__ROOT__
├── node1
│   ├── node15
│   │   ├── new_node
│   │   │   └── node2000
│   │   ├── node4000
│   │   └── node5000
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
└── node200
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">new_tree</span><span class="p">,</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;new_root&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">new_tree</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_tree</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">result2</span><span class="p">))</span>

<span class="n">copyundernode</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;copy_under&quot;</span><span class="p">)</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node1&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">copyundernode</span><span class="p">)</span>
<span class="n">node2</span> <span class="o">=</span> <span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node2&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">copyundernode</span><span class="p">)</span>
<span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>new_root
├── node1
│   ├── node15
│   │   ├── new_node
│   │   │   └── node2000
│   │   ├── node4000
│   │   └── node5000
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
└── node200

&lt;class &#39;treekit.treenode.TreeNode&#39;&gt;
&lt;class &#39;treekit.treenode.TreeNode&#39;&gt;
&lt;class &#39;treekit.flattree_node.FlatTreeNode&#39;&gt;
__ROOT__
├── node1
│   ├── node15
│   │   ├── new_node
│   │   │   └── node2000
│   │   ├── node4000
│   │   └── node5000
│   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
├── 9658556c-aa4a-485e-b499-4900d062c394
│   └── node4what
│       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
├── node200
└── new_root
    ├── node1
    │   ├── node15
    │   │   ├── new_node
    │   │   │   └── node2000
    │   │   ├── node4000
    │   │   └── node5000
    │   └── 29a49cbf-365a-47c3-a236-bf40e61960e3
    ├── 9658556c-aa4a-485e-b499-4900d062c394
    │   └── node4what
    │       └── 6f3a61c7-f4ba-47cd-b73d-4e1bcf7d0505
    └── node200
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatTreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code> is a bit more useful for operations that require
recursion, but any tree can support the sae operations. The <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>
is a bit more specialized for this purpose, and the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> is a
bit more specialized for more general storage and manipulation of data
that is tree-like, such as configuration data or log data. See
<code class="docutils literal notranslate"><span class="pre">TreeNode.md</span></code> for more information on the <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">node1</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node1&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">node2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node2&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">node3</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node3&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">node4</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node4&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">node5</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node5&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">node6</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node6&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">node7</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node7&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">node8</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node8&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">node9</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node9&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node6</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">node9</span><span class="p">[</span><span class="s2">&quot;what&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some data&quot;</span>
<span class="n">node9</span><span class="p">[</span><span class="s2">&quot;children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;__name__&quot;</span><span class="p">:</span> <span class="s2">&quot;YEAH&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">node8</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node13&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">13</span><span class="p">),</span>
    <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node14&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">14</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node14&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;node15&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)]</span>

<span class="c1"># print(json.dumps(root, indent=2))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;YEAH&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;node15&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root
├── node1
├── node2
└── node3
    ├── node4
    ├── node5
    ├── node6
    │   └── node9
    │       ├── -6548374021580866833
    │       ├── YEAH
    │       └── 2272134637651473476
    ├── node7
    └── node8
        ├── node13
        └── node14
            └── node15

TreeNode(name=YEAH, payload={&#39;value&#39;: 11})
TreeNode(name=node15, payload={&#39;value&#39;: 15})
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TreeViz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root
├── node1
├── node2
└── node3
    ├── node4
    ├── node5
    ├── node6
    │   └── node9
    │       ├── -6548374021580866833
    │       ├── YEAH
    │       └── 2272134637651473476
    ├── node7
    └── node8
        ├── node13
        └── node14
            └── node15
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">treekit</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="flattree.html">FlatTree</a></li>
<li class="toctree-l1"><a class="reference internal" href="treenode.html">TreeNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference: <cite>treekit</cite> Package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">FlatTree</span> <span class="pre">Notebook</span></code></a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="api.html" title="previous chapter">API Reference: <cite>treekit</cite> Package</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Alex Towell.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/flattree-notebook.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>